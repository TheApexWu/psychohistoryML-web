{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/amadeuswoo/Documents/GitHub/psychohistory-web/src/components/constants.js"],"sourcesContent":["/**\n * constants.js\n * ============\n * Configuration for the Polity Simulator\n * \n * IMPORTANT: All preset values are pulled directly from Seshat Equinox 2022 data.\n * Do NOT estimate values - they must match actual polities.json entries.\n * \n * Last updated: 2024-12-10\n * Data source: polities.json (372 polities)\n */\n\n// Feature order must match scaler-params.json\nexport const FEATURE_ORDER = [\n  'hierarchy',      // Hier - Administrative levels (1-9)\n  'government',     // Gov - Government sophistication (0-1)\n  'information',    // Info - Information systems (0-1)\n  'infrastructure', // Infra - Infrastructure development (0-1)\n  'weapons',        // Weapon - Weapon types (0-6)\n  'armor',          // Armor - Armor sophistication (0-8)\n  'cavalry',        // Cavalry - Cavalry presence (0-1, binary in data)\n  'fortifications', // Defense - Fortification levels (0-11)\n  'ironWorking',    // Iron - Iron working (0-1, binary)\n  'religion',       // ReligLev - Religious hierarchy (0-10)\n];\n\n// Historical eras with date ranges\nexport const ERAS = ['Ancient', 'Classical', 'Medieval', 'Early Modern'];\n\nexport const ERA_DESCRIPTIONS = {\n  'Ancient': 'Before 500 BCE — Early civilizations, bronze age societies',\n  'Classical': '500 BCE – 500 CE — Rome, Han China, Persian empires',\n  'Medieval': '500 – 1500 CE — Feudal Europe, Islamic Golden Age, Mongol conquests',\n  'Early Modern': 'After 1500 CE — Colonial empires, gunpowder states',\n};\n\n// Parameter definitions with accurate Seshat ranges\n// Ranges verified against actual polities.json min/max values\nexport const PARAMETERS = {\n  // === COMPLEXITY ===\n  hierarchy: {\n    label: 'Hierarchy',\n    min: 1,\n    max: 9,        // Max in data: 8.67 (Spanish Empire)\n    step: 0.5,\n    default: 4,\n    category: 'complexity',\n    description: '1 = village headman, 4 = regional kingdoms, 7+ = multi-tiered empires',\n  },\n  government: {\n    label: 'Government',\n    min: 0,\n    max: 1,\n    step: 0.05,\n    default: 0.5,\n    category: 'complexity',\n    description: '0 = informal rule, 0.5 = emerging bureaucracy, 1 = sophisticated administration',\n  },\n  information: {\n    label: 'Information',\n    min: 0,\n    max: 1,\n    step: 0.05,\n    default: 0.5,\n    category: 'complexity',\n    description: '0 = oral only, 0.5 = limited writing, 1 = extensive records & literature',\n  },\n  infrastructure: {\n    label: 'Infrastructure',\n    min: 0,\n    max: 1,\n    step: 0.05,\n    default: 0.5,\n    category: 'complexity',\n    description: '0 = paths only, 0.5 = regional roads, 1 = empire-wide road networks & aqueducts',\n  },\n  \n  // === WARFARE ===\n  weapons: {\n    label: 'Weapons',\n    min: 0,\n    max: 6,        // Max in data: 6.0\n    step: 0.1,\n    default: 3,\n    category: 'warfare',\n    description: '0 = clubs/stones, 3 = bronze swords, 6 = advanced steel + gunpowder',\n  },\n  armor: {\n    label: 'Armor',\n    min: 0,\n    max: 8,        // Max in data: 8.0\n    step: 0.5,\n    default: 4,\n    category: 'warfare',\n    description: '0 = none, 4 = chain mail, 8 = full plate armor',\n  },\n  cavalry: {\n    label: 'Cavalry',\n    min: 0,\n    max: 1,        // Binary in actual data\n    step: 1,\n    default: 1,\n    category: 'warfare',\n    description: '0 = no cavalry, 1 = cavalry present',\n  },\n  fortifications: {\n    label: 'Fortifications',\n    min: 0,\n    max: 11,       // Max in data: 10.0, but allowing 11 for slider UX\n    step: 0.5,\n    default: 5,\n    category: 'warfare',\n    description: '0 = no fortifications, 5 = walled cities, 10+ = complex defensive networks',\n  },\n  ironWorking: {\n    label: 'Iron Working',\n    min: 0,\n    max: 1,        // Binary in actual data\n    step: 1,\n    default: 1,\n    category: 'warfare',\n    description: '0 = no iron, 1 = iron working present',\n  },\n  \n  // === RELIGION ===\n  religion: {\n    label: 'Religious Hierarchy',\n    min: 0,\n    max: 10,       // Max in data: 10.0 (Spanish Empire)\n    step: 0.5,\n    default: 3,\n    category: 'religion',\n    description: '0 = animist, 2 = local priests, 5 = state religion, 10 = complex hierarchy',\n  },\n};\n\n/**\n * PRESETS\n * =======\n * ALL values pulled directly from polities.json rawFeatures.\n * Names match Seshat polity names exactly.\n * \n * To add a new preset:\n * 1. Find the polity in polities.json\n * 2. Copy its rawFeatures values exactly\n * 3. Use the polity's actual name\n */\nexport const PRESETS = {\n  // Classical era - Empires\n  'Roman Republic': {\n    // From: \"Roman Republic\" (Classical, 244 yrs)\n    hierarchy: 4.67,\n    government: 0.36,\n    information: 0.89,\n    infrastructure: 0.67,\n    weapons: 4.9,\n    armor: 7.5,\n    cavalry: 1,\n    fortifications: 6.0,\n    ironWorking: 1,\n    religion: 4.0,\n  },\n  'Roman Empire': {\n    // From: \"Roman Empire - Principate\" (Classical, 314 yrs)\n    hierarchy: 8.17,\n    government: 0.65,\n    information: 0.92,\n    infrastructure: 0.99,\n    weapons: 2.9,\n    armor: 8.0,\n    cavalry: 1,\n    fortifications: 10.0,\n    ironWorking: 1,\n    religion: 4.0,\n  },\n  'Achaemenid Persia': {\n    // From: \"Achaemenid Empire\" (Classical, 208 yrs)\n    hierarchy: 6.5,\n    government: 0.99,\n    information: 0.95,\n    infrastructure: 0.97,\n    weapons: 4.1,\n    armor: 7.6,\n    cavalry: 1,\n    fortifications: 9.4,\n    ironWorking: 1,\n    religion: 4.0,\n  },\n  'Han Dynasty': {\n    // From: \"Western Han\" (Classical, 211 yrs)\n    hierarchy: 6.83,\n    government: 0.74,\n    information: 0.91,\n    infrastructure: 0.97,\n    weapons: 5.9,\n    armor: 7.8,\n    cavalry: 1,\n    fortifications: 7.6,\n    ironWorking: 1,\n    religion: 3.0,\n  },\n  \n  // Medieval era\n  'Byzantine Empire': {\n    // From: \"Byzantine Empire I\" (Medieval, 234 yrs)\n    hierarchy: 7.33,\n    government: 0.91,\n    information: 0.92,\n    infrastructure: 0.9,\n    weapons: 6.0,\n    armor: 8.0,\n    cavalry: 1,\n    fortifications: 10.0,\n    ironWorking: 1,\n    religion: 7.0,\n  },\n  'Mongol Empire': {\n    // From: \"Mongol Empire\" (Medieval, 94 yrs)\n    hierarchy: 5.0,\n    government: 0.78,\n    information: 0.54,\n    infrastructure: 0.99,\n    weapons: 6.0,\n    armor: 6.0,\n    cavalry: 1,\n    fortifications: 5.0,\n    ironWorking: 1,\n    religion: 3.0,\n  },\n  'Aztec Empire': {\n    // From: \"Aztec Empire\" (Medieval, 92 yrs)\n    hierarchy: 5.83,\n    government: 0.77,\n    information: 0.54,\n    infrastructure: 1.0,\n    weapons: 5.0,\n    armor: 3.0,\n    cavalry: 0,          // No horses in Americas\n    fortifications: 4.3,\n    ironWorking: 0,      // No iron working\n    religion: 2.5,\n  },\n  \n  // Early Modern era\n  'Spanish Empire': {\n    // From: \"Spanish Empire\" (Early Modern, 168 yrs)\n    // Note: Most religiously institutionalized polity in dataset (religion=10)\n    // Actual Seshat values - DO NOT MODIFY\n    hierarchy: 8.67,     // NOT 9 - actual value is 8.67\n    government: 0.92,\n    information: 0.92,\n    infrastructure: 0.99,\n    weapons: 5.8,\n    armor: 8.0,\n    cavalry: 1,\n    fortifications: 9.1,\n    ironWorking: 1,\n    religion: 10.0,      // Maximum in dataset - this is correct\n  },\n  'Ottoman Empire': {\n    // From: \"Ottoman Empire II\" (Early Modern, 165 yrs)\n    hierarchy: 8.17,\n    government: 1.0,\n    information: 1.0,\n    infrastructure: 0.92,\n    weapons: 5.9,\n    armor: 8.0,\n    cavalry: 1,\n    fortifications: 8.0,\n    ironWorking: 1,\n    religion: 4.0,\n  },\n  \n  // Ancient era\n  'Late Shang': {\n    // From: \"Late Shang\" (Ancient, 204 yrs)\n    hierarchy: 4.0,\n    government: 0.54,\n    information: 0.36,\n    infrastructure: 0.83,\n    weapons: 5.9,\n    armor: 4.0,\n    cavalry: 0,\n    fortifications: 6.5,\n    ironWorking: 0,\n    religion: 3.0,\n  },\n};\n\n// Default config - median-ish values for exploration\nexport const DEFAULT_CONFIG = {\n  hierarchy: 5,\n  government: 0.5,\n  information: 0.5,\n  infrastructure: 0.5,\n  weapons: 4,\n  armor: 5,\n  cavalry: 1,\n  fortifications: 5,\n  ironWorking: 1,\n  religion: 4,\n};\n\n// Category colors for UI grouping\nexport const CATEGORY_COLORS = {\n  complexity: '#60a5fa',  // blue\n  warfare: '#f87171',     // red\n  religion: '#fbbf24',    // amber\n};\n\n/**\n * DATA RANGES (from actual polities.json)\n * For reference when validating user inputs\n * \n * hierarchy:      1.0 - 8.67\n * government:     0.0 - 1.0\n * information:    0.0 - 1.0\n * infrastructure: 0.0 - 1.0\n * weapons:        0.0 - 6.0\n * armor:          0.0 - 8.0\n * cavalry:        0.0 - 1.0\n * fortifications: 0.0 - 10.0\n * ironWorking:    0.0 - 1.0\n * religion:       0.0 - 10.0\n */"],"names":[],"mappings":"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"}},
    {"offset": {"line": 326, "column": 0}, "map": {"version":3,"sources":["file:///Users/amadeuswoo/Documents/GitHub/psychohistory-web/src/components/similarity.js"],"sourcesContent":["// src/components/similarity.js\n// Client-side similarity calculations for the Polity Simulator\n\nimport { FEATURE_ORDER } from './constants';\n\n/**\n * Compute cosine similarity between two vectors\n * @param {number[]} a - First vector\n * @param {number[]} b - Second vector\n * @returns {number} Cosine similarity (-1 to 1)\n */\nexport function cosineSimilarity(a, b) {\n  if (a.length !== b.length) {\n    throw new Error('Vectors must have same length');\n  }\n  \n  let dotProduct = 0;\n  let normA = 0;\n  let normB = 0;\n  \n  for (let i = 0; i < a.length; i++) {\n    dotProduct += a[i] * b[i];\n    normA += a[i] * a[i];\n    normB += b[i] * b[i];\n  }\n  \n  const denominator = Math.sqrt(normA) * Math.sqrt(normB);\n  if (denominator === 0) return 0;\n  \n  return dotProduct / denominator;\n}\n\n/**\n * Standardize user input values using pre-computed scaler parameters\n * @param {number[]} values - Raw feature values in FEATURE_ORDER\n * @param {number[]} mean - Mean values from scaler\n * @param {number[]} std - Standard deviation values from scaler\n * @returns {number[]} Standardized values\n */\nexport function standardize(values, mean, std) {\n  return values.map((v, i) => (v - mean[i]) / std[i]);\n}\n\n/**\n * Convert user config object to feature array in correct order\n * @param {Object} config - User configuration with parameter names as keys\n * @returns {number[]} Feature values in FEATURE_ORDER\n */\nexport function configToFeatures(config) {\n  return FEATURE_ORDER.map(key => config[key] ?? 0);\n}\n\n/**\n * Find k most similar polities to user configuration\n * @param {Object} config - User configuration\n * @param {Object[]} polities - Array of polity objects with 'features' array\n * @param {Object} scalerParams - Scaler parameters with 'mean' and 'std' arrays\n * @param {Object} options - Search options\n * @returns {Object} Results with similar polities and duration estimate\n */\nexport function findSimilarPolities(config, polities, scalerParams, options = {}) {\n  const {\n    k = 5,\n    era = null,\n    maxDuration = 1000,\n    minSimilarity = 0\n  } = options;\n  \n  // Convert user config to feature array and standardize\n  const userFeatures = configToFeatures(config);\n  const userScaled = standardize(userFeatures, scalerParams.mean, scalerParams.std);\n  \n  // Filter candidates\n  let candidates = polities.filter(p => p.duration <= maxDuration);\n  if (era) {\n    candidates = candidates.filter(p => p.era === era);\n  }\n  \n  if (candidates.length === 0) {\n    return {\n      similar: [],\n      durationEstimate: null,\n      durationRange: [null, null],\n      confidence: 0,\n      candidateCount: 0,\n      message: era ? `No polities found in ${era} era` : 'No polities found'\n    };\n  }\n  \n  // Compute similarities\n  const withSimilarity = candidates.map(p => ({\n    ...p,\n    similarity: cosineSimilarity(userScaled, p.features)\n  }));\n  \n  // Filter by minimum similarity if specified\n  let filtered = withSimilarity;\n  if (minSimilarity > 0) {\n    filtered = withSimilarity.filter(p => p.similarity >= minSimilarity);\n  }\n  \n  // Sort by similarity (descending) and take top k\n  filtered.sort((a, b) => b.similarity - a.similarity);\n  const topK = filtered.slice(0, k);\n  \n  if (topK.length === 0) {\n    return {\n      similar: [],\n      durationEstimate: null,\n      durationRange: [null, null],\n      confidence: 0,\n      candidateCount: candidates.length,\n      message: 'No sufficiently similar polities found'\n    };\n  }\n  \n  // Compute weighted duration estimate\n  const weights = topK.map(p => Math.max(p.similarity, 0));\n  const totalWeight = weights.reduce((sum, w) => sum + w, 0);\n  \n  let durationEstimate;\n  if (totalWeight > 0) {\n    durationEstimate = topK.reduce((sum, p, i) => sum + weights[i] * p.duration, 0) / totalWeight;\n  } else {\n    durationEstimate = topK.reduce((sum, p) => sum + p.duration, 0) / topK.length;\n  }\n  \n  // Compute confidence score\n  const meanSimilarity = weights.reduce((sum, w) => sum + w, 0) / topK.length;\n  const meanDuration = topK.reduce((sum, p) => sum + p.duration, 0) / topK.length;\n  const durationVariance = topK.reduce((sum, p) => sum + Math.pow(p.duration - meanDuration, 2), 0) / topK.length;\n  const durationStd = Math.sqrt(durationVariance);\n  const cv = durationStd / (meanDuration + 1); // Coefficient of variation\n  const confidence = meanSimilarity / (1 + cv);\n  \n  // Format results\n  const similar = topK.map(p => ({\n    name: p.name,\n    era: p.era,\n    duration: p.duration,\n    start: p.start,\n    end: p.end,\n    region: p.region,\n    similarity: Math.round(p.similarity * 1000) / 10 // Percentage with 1 decimal\n  }));\n  \n  const durations = topK.map(p => p.duration);\n  \n  return {\n    similar,\n    durationEstimate: Math.round(durationEstimate),\n    durationRange: [Math.min(...durations), Math.max(...durations)],\n    confidence: Math.round(confidence * 100) / 100,\n    candidateCount: candidates.length,\n    message: null\n  };\n}\n\n/**\n * Compare duration estimates across all eras\n * @param {Object} config - User configuration\n * @param {Object[]} polities - Array of polity objects\n * @param {Object} scalerParams - Scaler parameters\n * @param {Object} options - Search options (k, maxDuration)\n * @returns {Object[]} Array of era comparison results\n */\nexport function compareEras(config, polities, scalerParams, options = {}) {\n  const eras = ['Ancient', 'Classical', 'Medieval', 'Early Modern'];\n  \n  return eras.map(era => {\n    const result = findSimilarPolities(config, polities, scalerParams, {\n      ...options,\n      era\n    });\n    \n    return {\n      era,\n      durationEstimate: result.durationEstimate,\n      durationRange: result.durationRange,\n      confidence: result.confidence,\n      candidateCount: result.candidateCount,\n      topMatch: result.similar[0] || null\n    };\n  });\n}\n\n/**\n * Get risk assessment based on duration estimate\n * @param {number} durationEstimate - Estimated duration in years\n * @returns {Object} Risk assessment with level and description\n */\nexport function getRiskAssessment(durationEstimate) {\n  if (durationEstimate === null) {\n    return {\n      level: 'unknown',\n      color: '#6b7280',\n      description: 'Insufficient data for assessment'\n    };\n  }\n  \n  if (durationEstimate >= 300) {\n    return {\n      level: 'lower',\n      color: '#22c55e',\n      description: 'Above average longevity expected'\n    };\n  } else if (durationEstimate >= 184) {\n    return {\n      level: 'moderate',\n      color: '#eab308',\n      description: 'Average longevity expected (above median)'\n    };\n  } else if (durationEstimate >= 100) {\n    return {\n      level: 'elevated',\n      color: '#f97316',\n      description: 'Below median longevity expected'\n    };\n  } else {\n    return {\n      level: 'higher',\n      color: '#ef4444',\n      description: 'Significantly below average longevity'\n    };\n  }\n}\n\n/**\n * Format duration for display\n * @param {number} years - Duration in years\n * @returns {string} Formatted string\n */\nexport function formatDuration(years) {\n  if (years === null || years === undefined) return '—';\n  if (years < 100) return `${years} years`;\n  if (years < 200) return `~${Math.round(years / 10) * 10} years`;\n  return `~${Math.round(years / 50) * 50} years`;\n}\n\n/**\n * Format year for display (handles BCE/CE)\n * @param {number} year - Year (negative for BCE)\n * @returns {string} Formatted string\n */\nexport function formatYear(year) {\n  if (year < 0) {\n    return `${Math.abs(year)} BCE`;\n  } else if (year < 100) {\n    return `${year} CE`;\n  } else {\n    return `${year}`;\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 536, "column": 0}, "map": {"version":3,"sources":["file:///Users/amadeuswoo/Documents/GitHub/psychohistory-web/src/app/predict/page.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { \n  PARAMETERS, \n  ERAS, \n  ERA_DESCRIPTIONS,\n  PRESETS, \n  DEFAULT_CONFIG \n} from '../../components/constants';\nimport { \n  findSimilarPolities, \n  getRiskAssessment,\n  formatYear \n} from '../../components/similarity';\nimport Link from 'next/link';\n\n// Era colors\nconst ERA_COLORS = {\n  'Ancient': { bg: 'bg-amber-500/20', text: 'text-amber-400', border: 'border-amber-500/30', dot: 'bg-amber-400' },\n  'Classical': { bg: 'bg-blue-500/20', text: 'text-blue-400', border: 'border-blue-500/30', dot: 'bg-blue-400' },\n  'Medieval': { bg: 'bg-purple-500/20', text: 'text-purple-400', border: 'border-purple-500/30', dot: 'bg-purple-400' },\n  'Early Modern': { bg: 'bg-green-500/20', text: 'text-green-400', border: 'border-green-500/30', dot: 'bg-green-400' },\n};\n\n// Detect outliers\nfunction detectOutliers(config, allPolities, selectedEra) {\n  const outliers = [];\n  const pool = selectedEra \n    ? allPolities.filter(p => p.era === selectedEra)\n    : allPolities;\n  \n  if (pool.length < 10) return outliers;\n  \n  const featureKeys = [\n    'hierarchy', 'government', 'information', 'infrastructure',\n    'weapons', 'armor', 'cavalry', 'fortifications', 'ironWorking', 'religion'\n  ];\n  \n  featureKeys.forEach(key => {\n    const values = pool\n      .filter(p => p.rawFeatures && p.rawFeatures[key] !== undefined)\n      .map(p => p.rawFeatures[key]);\n    \n    if (values.length < 10) return;\n    \n    const min = Math.min(...values);\n    const max = Math.max(...values);\n    const userVal = config[key];\n    \n    // Only flag if OUTSIDE the historical range\n    if (userVal < min - 0.01 || userVal > max + 0.01) {\n      outliers.push({\n        feature: key,\n        label: PARAMETERS[key]?.label || key,\n        userVal,\n        min,\n        max,\n        message: userVal > max \n          ? `Exceeds historical maximum (${max.toFixed(1)})`\n          : `Below historical minimum (${min.toFixed(1)})`\n      });\n    }\n  });\n  \n  return outliers;\n}\n\nexport default function PredictPage() {\n  const [config, setConfig] = useState(DEFAULT_CONFIG);\n  const [selectedEra, setSelectedEra] = useState(null);\n  const [polities, setPolities] = useState([]);\n  const [scalerParams, setScalerParams] = useState(null);\n  const [results, setResults] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [activePreset, setActivePreset] = useState(null);\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  const [expandedMatch, setExpandedMatch] = useState(null);\n\n  // Load data\n  useEffect(() => {\n    async function loadData() {\n      try {\n        const [politiesRes, scalerRes] = await Promise.all([\n          fetch('/data/polities.json'),\n          fetch('/data/scaler-params.json')\n        ]);\n        setPolities(await politiesRes.json());\n        setScalerParams(await scalerRes.json());\n        setIsLoading(false);\n      } catch (error) {\n        console.error('Failed to load data:', error);\n        setIsLoading(false);\n      }\n    }\n    loadData();\n  }, []);\n\n  // Compute results\n  useEffect(() => {\n    if (!polities.length || !scalerParams) return;\n    const similarityResults = findSimilarPolities(\n      config, polities, scalerParams, \n      { k: 5, era: selectedEra, maxDuration: 1000 }\n    );\n    setResults(similarityResults);\n    setExpandedMatch(null);\n  }, [config, selectedEra, polities, scalerParams]);\n\n  // Detect outliers\n  const outliers = useMemo(() => {\n    if (!polities.length) return [];\n    return detectOutliers(config, polities, selectedEra);\n  }, [config, polities, selectedEra]);\n\n  const outlierKeys = useMemo(() => new Set(outliers.map(o => o.feature)), [outliers]);\n\n  const handleParamChange = (key, value) => {\n    const param = PARAMETERS[key];\n    const numValue = parseFloat(value);\n    if (isNaN(numValue)) return;\n    const clampedValue = Math.min(Math.max(numValue, param.min), param.max);\n    setConfig(prev => ({ ...prev, [key]: clampedValue }));\n    setActivePreset(null);\n  };\n\n  const handlePresetSelect = (presetName) => {\n    setConfig(PRESETS[presetName]);\n    setActivePreset(presetName);\n  };\n\n  const risk = results ? getRiskAssessment(results.durationEstimate) : null;\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-gray-400\">Loading historical data...</div>\n      </div>\n    );\n  }\n\n  // Group parameters\n  const complexityParams = Object.entries(PARAMETERS).filter(([_, p]) => p.category === 'complexity');\n  const warfareParams = Object.entries(PARAMETERS).filter(([_, p]) => p.category === 'warfare');\n  const religionParams = Object.entries(PARAMETERS).filter(([_, p]) => p.category === 'religion');\n\n  return (\n    <div className=\"predict-page\">\n      {/* Hero */}\n      <section className=\"hero\" style={{ paddingBottom: '2rem' }}>\n        <h1>Polity Simulator</h1>\n        <p className=\"subtitle\">\n          Configure a hypothetical civilization and discover which historical societies \n          shared similar characteristics. Based on 372 polities from the Seshat database.\n        </p>\n      </section>\n\n      <div className=\"max-w-6xl mx-auto px-6 pb-16\">\n        \n        {/* Presets */}\n        <section className=\"mb-8\">\n          <h2 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4\">\n            Quick Presets\n          </h2>\n          <div className=\"flex flex-wrap gap-3\">\n            {Object.keys(PRESETS).map(preset => (\n              <button\n                key={preset}\n                onClick={() => handlePresetSelect(preset)}\n                className={`px-5 py-2.5 rounded-lg text-sm font-medium transition-all ${\n                  activePreset === preset\n                    ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/20'\n                    : 'bg-[#161616] text-gray-300 hover:bg-[#1a1a1a] border border-gray-800'\n                }`}\n              >\n                {preset}\n              </button>\n            ))}\n          </div>\n        </section>\n\n        {/* Main Grid */}\n        <div className=\"grid lg:grid-cols-5 gap-8\">\n          \n          {/* Left: Configuration (3 cols) */}\n          <div className=\"lg:col-span-3 space-y-6\">\n            \n            {/* Outlier Warning - Only show if outliers exist */}\n            {outliers.length > 0 && (\n              <div className=\"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <span className=\"text-amber-400 text-lg\">⚠️</span>\n                  <div>\n                    <p className=\"text-sm font-medium text-amber-400\">\n                      {outliers.length} value{outliers.length > 1 ? 's' : ''} outside historical range\n                    </p>\n                    <p className=\"text-xs text-amber-400/70 mt-1\">\n                      Your configuration includes values no historical polity had. \n                      Results may be less reliable.\n                    </p>\n                    <div className=\"mt-2 space-y-1\">\n                      {outliers.map((o, i) => (\n                        <div key={o.feature} className=\"text-xs text-amber-400/80\">\n                          • {o.label}: {o.message}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Parameters Card */}\n            <div className=\"card\">\n              <h3 className=\"text-lg font-semibold text-white mb-6\">Configure Your Polity</h3>\n              \n              {/* Complexity Section */}\n              <div className=\"mb-8\">\n                <h4 className=\"text-xs uppercase tracking-widest text-blue-400 mb-4 flex items-center gap-2 font-semibold\">\n                  <span className=\"w-2.5 h-2.5 rounded-full bg-blue-400\"></span>\n                  Complexity\n                </h4>\n                <div className=\"space-y-5\">\n                  {complexityParams.map(([key, param]) => (\n                    <ParameterControl\n                      key={key}\n                      paramKey={key}\n                      param={param}\n                      value={config[key]}\n                      onChange={handleParamChange}\n                      isOutlier={outlierKeys.has(key)}\n                    />\n                  ))}\n                </div>\n              </div>\n\n              {/* Warfare Section */}\n              <div className=\"mb-8\">\n                <h4 className=\"text-xs uppercase tracking-widest text-red-400 mb-4 flex items-center gap-2 font-semibold\">\n                  <span className=\"w-2.5 h-2.5 rounded-full bg-red-400\"></span>\n                  Warfare\n                </h4>\n                \n                {/* Show first 2, hide rest behind toggle */}\n                <div className=\"space-y-5\">\n                  {warfareParams.slice(0, 2).map(([key, param]) => (\n                    <ParameterControl\n                      key={key}\n                      paramKey={key}\n                      param={param}\n                      value={config[key]}\n                      onChange={handleParamChange}\n                      isOutlier={outlierKeys.has(key)}\n                    />\n                  ))}\n                </div>\n                \n                {!showAdvanced && warfareParams.length > 2 && (\n                  <button\n                    onClick={() => setShowAdvanced(true)}\n                    className=\"mt-4 text-sm text-gray-500 hover:text-gray-300 transition\"\n                  >\n                    + Show {warfareParams.length - 2} more warfare parameters\n                  </button>\n                )}\n                \n                {showAdvanced && (\n                  <div className=\"mt-5 space-y-5\">\n                    {warfareParams.slice(2).map(([key, param]) => (\n                      <ParameterControl\n                        key={key}\n                        paramKey={key}\n                        param={param}\n                        value={config[key]}\n                        onChange={handleParamChange}\n                        isOutlier={outlierKeys.has(key)}\n                      />\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Religion Section */}\n              <div>\n                <h4 className=\"text-xs uppercase tracking-widest text-amber-400 mb-4 flex items-center gap-2 font-semibold\">\n                  <span className=\"w-2.5 h-2.5 rounded-full bg-amber-400\"></span>\n                  Religion\n                </h4>\n                <div className=\"space-y-5\">\n                  {religionParams.map(([key, param]) => (\n                    <ParameterControl\n                      key={key}\n                      paramKey={key}\n                      param={param}\n                      value={config[key]}\n                      onChange={handleParamChange}\n                      isOutlier={outlierKeys.has(key)}\n                    />\n                  ))}\n                </div>\n              </div>\n              \n              {showAdvanced && (\n                <button\n                  onClick={() => setShowAdvanced(false)}\n                  className=\"mt-6 text-sm text-gray-500 hover:text-gray-300 transition\"\n                >\n                  − Hide advanced parameters\n                </button>\n              )}\n            </div>\n\n            {/* Era Filter */}\n            <div className=\"card\">\n              <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4\">\n                Filter by Era\n              </h3>\n              <div className=\"flex flex-wrap gap-2\">\n                <button\n                  onClick={() => setSelectedEra(null)}\n                  className={`px-4 py-2 rounded-lg text-sm font-medium transition ${\n                    selectedEra === null\n                      ? 'bg-gray-700 text-white'\n                      : 'bg-[#161616] text-gray-400 hover:bg-[#1a1a1a] border border-gray-800'\n                  }`}\n                >\n                  All Eras\n                </button>\n                {ERAS.map(era => {\n                  const colors = ERA_COLORS[era];\n                  return (\n                    <button\n                      key={era}\n                      onClick={() => setSelectedEra(era)}\n                      className={`px-4 py-2 rounded-lg text-sm font-medium transition ${\n                        selectedEra === era\n                          ? `${colors.bg} ${colors.text} border ${colors.border}`\n                          : 'bg-[#161616] text-gray-400 hover:bg-[#1a1a1a] border border-gray-800'\n                      }`}\n                    >\n                      {era}\n                    </button>\n                  );\n                })}\n              </div>\n              {selectedEra && (\n                <p className=\"mt-3 text-sm text-gray-500\">{ERA_DESCRIPTIONS[selectedEra]}</p>\n              )}\n              {!selectedEra && (\n                <p className=\"mt-3 text-xs text-gray-600\">\n                  Tip: The same configuration meant different things in different periods. \n                  Filter by era for more meaningful comparisons.\n                </p>\n              )}\n            </div>\n          </div>\n\n          {/* Right: Results (2 cols) */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            \n            {/* Main Result Card */}\n            {results && (\n              <div className=\"card text-center\">\n                <p className=\"text-sm text-gray-500 mb-2\">Estimated Duration</p>\n                <div \n                  className=\"text-5xl font-bold mb-1\"\n                  style={{ color: risk?.color || '#f97316' }}\n                >\n                  ~{results.durationEstimate}\n                </div>\n                <p className=\"text-gray-500 mb-4\">years</p>\n                \n                {/* Range */}\n                <div className=\"flex justify-center gap-6 mb-4 text-sm\">\n                  <div className=\"text-center\">\n                    <div className=\"text-white font-semibold\">{results.durationRange[0]}–{results.durationRange[1]}</div>\n                    <div className=\"text-xs text-gray-500 uppercase\">Range</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-white font-semibold\">{Math.round(results.confidence * 100)}%</div>\n                    <div className=\"text-xs text-gray-500 uppercase\">Confidence</div>\n                  </div>\n                </div>\n\n                {/* Risk badge */}\n                {risk && (\n                  <div \n                    className=\"inline-block px-4 py-2 rounded-lg text-sm font-medium\"\n                    style={{ backgroundColor: `${risk.color}15`, color: risk.color }}\n                  >\n                    {risk.description}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Similar Polities */}\n            {results?.similar?.length > 0 && (\n              <div className=\"card\">\n                <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4\">\n                  Most Similar Polities\n                </h3>\n                <div className=\"space-y-2\">\n                  {results.similar.map((polity, i) => {\n                    const colors = ERA_COLORS[polity.era] || ERA_COLORS['Ancient'];\n                    const isExpanded = expandedMatch === i;\n                    const fullPolity = polities.find(p => p.name === polity.name);\n                    \n                    return (\n                      <div key={`${polity.name}-${i}`}>\n                        <button\n                          onClick={() => setExpandedMatch(isExpanded ? null : i)}\n                          className=\"w-full text-left p-3 rounded-lg bg-[#0d0d0d] hover:bg-[#111] transition\"\n                        >\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"flex items-center gap-2\">\n                                <span className={`w-2 h-2 rounded-full ${colors.dot}`}></span>\n                                <span className=\"font-medium text-white text-sm truncate\">\n                                  {polity.name}\n                                </span>\n                              </div>\n                              <div className=\"text-xs text-gray-600 mt-0.5 ml-4\">\n                                {polity.duration} years · {polity.era}\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-3\">\n                              <span className=\"text-sm font-semibold text-blue-400\">\n                                {polity.similarity}%\n                              </span>\n                              <span className=\"text-gray-600 text-xs\">\n                                {isExpanded ? '▼' : '▶'}\n                              </span>\n                            </div>\n                          </div>\n                        </button>\n                        \n                        {/* Expanded Details */}\n                        {isExpanded && fullPolity && (\n                          <ExpandedPolityDetails \n                            config={config}\n                            polity={polity}\n                            fullPolity={fullPolity}\n                          />\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n                \n                <p className=\"text-xs text-gray-600 mt-4\">\n                  Estimate is a similarity-weighted average of these polities' durations.\n                </p>\n              </div>\n            )}\n\n            {/* Caveat */}\n            <div className=\"p-4 border-l-2 border-amber-600/50 bg-[#0d0d0d] rounded-r-lg\">\n              <p className=\"text-sm text-gray-500\">\n                <strong className=\"text-gray-400\">Note:</strong> This is pattern-matching, not prediction. \n                Similar configurations produced different outcomes depending on leadership, geography, \n                and luck — none of which are in our model.\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* Methodology Link */}\n        <div className=\"mt-16 text-center\">\n          <Link \n            href=\"/predict/methodology\" \n            className=\"text-gray-500 hover:text-gray-300 transition\"\n          >\n            How does this work? Read the methodology →\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Parameter Control with Slider + Number Input\nfunction ParameterControl({ paramKey, param, value, onChange, isOutlier }) {\n  const [inputValue, setInputValue] = useState(value.toString());\n\n  useEffect(() => {\n    setInputValue(value.toString());\n  }, [value]);\n\n  const handleInputChange = (e) => {\n    setInputValue(e.target.value);\n  };\n\n  const handleInputBlur = () => {\n    const num = parseFloat(inputValue);\n    if (!isNaN(num)) {\n      onChange(paramKey, num);\n    } else {\n      setInputValue(value.toString());\n    }\n  };\n\n  const handleInputKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      e.target.blur();\n    }\n  };\n\n  return (\n    <div className={isOutlier ? 'relative' : ''}>\n      {isOutlier && (\n        <span className=\"absolute -left-4 top-1 text-amber-400 text-sm\" title=\"Value outside historical range\">⚠️</span>\n      )}\n      <div className=\"flex justify-between items-center mb-2\">\n        <label className={`text-base font-medium ${isOutlier ? 'text-amber-300' : 'text-gray-200'}`}>\n          {param.label}\n        </label>\n        <input\n          type=\"text\"\n          value={inputValue}\n          onChange={handleInputChange}\n          onBlur={handleInputBlur}\n          onKeyDown={handleInputKeyDown}\n          className={`w-16 px-2 py-1 text-right text-base font-medium border rounded focus:outline-none focus:border-blue-500 transition ${\n            isOutlier \n              ? 'bg-amber-500/10 border-amber-500/30 text-amber-300' \n              : 'bg-gray-800/50 border-gray-700/50 text-white'\n          }`}\n        />\n      </div>\n      <input\n        type=\"range\"\n        min={param.min}\n        max={param.max}\n        step={param.step}\n        value={value}\n        onChange={(e) => onChange(paramKey, e.target.value)}\n        className=\"w-full h-2 bg-gray-700/50 rounded-full appearance-none cursor-pointer\n                   [&::-webkit-slider-thumb]:appearance-none\n                   [&::-webkit-slider-thumb]:w-4\n                   [&::-webkit-slider-thumb]:h-4\n                   [&::-webkit-slider-thumb]:rounded-full\n                   [&::-webkit-slider-thumb]:bg-white\n                   [&::-webkit-slider-thumb]:cursor-pointer\n                   [&::-webkit-slider-thumb]:transition\n                   [&::-webkit-slider-thumb]:hover:bg-gray-200\n                   [&::-webkit-slider-thumb]:shadow-md\"\n      />\n      <p className=\"text-sm text-gray-500 mt-1.5\">{param.description}</p>\n    </div>\n  );\n}\n\n// Expanded Polity Details\nfunction ExpandedPolityDetails({ config, polity, fullPolity }) {\n  const featureMapping = [\n    { key: 'hierarchy', label: 'Hierarchy' },\n    { key: 'government', label: 'Government' },\n    { key: 'information', label: 'Information' },\n    { key: 'infrastructure', label: 'Infrastructure' },\n    { key: 'weapons', label: 'Weapons' },\n    { key: 'armor', label: 'Armor' },\n    { key: 'cavalry', label: 'Cavalry' },\n    { key: 'fortifications', label: 'Fortifications' },\n    { key: 'ironWorking', label: 'Iron Working' },\n    { key: 'religion', label: 'Religion' },\n  ];\n\n  const hasRawFeatures = fullPolity?.rawFeatures;\n\n  return (\n    <div className=\"mt-2 p-4 bg-[#080808] rounded-lg border border-gray-800/50 text-sm\">\n      {/* Basic Info */}\n      <div className=\"grid grid-cols-2 gap-2 text-xs mb-4\">\n        <div className=\"text-gray-500\">Period</div>\n        <div className=\"text-gray-300\">\n          {formatYear(polity.start)} – {formatYear(polity.end)}\n        </div>\n        <div className=\"text-gray-500\">Duration</div>\n        <div className=\"text-gray-300\">{polity.duration} years</div>\n        <div className=\"text-gray-500\">Similarity</div>\n        <div className=\"text-gray-300\">{polity.similarity}% match</div>\n      </div>\n      \n      {/* Feature Comparison Table */}\n      {hasRawFeatures && (\n        <div className=\"border-t border-gray-800 pt-3\">\n          <div className=\"text-xs text-gray-500 mb-2 uppercase tracking-wider\">Feature Comparison</div>\n          \n          {/* Header */}\n          <div className=\"grid grid-cols-4 gap-1 text-xs mb-1\">\n            <div className=\"text-gray-600\">Feature</div>\n            <div className=\"text-gray-600 text-center\">You</div>\n            <div className=\"text-gray-600 text-center\">Them</div>\n            <div className=\"text-gray-600 text-right\">Diff</div>\n          </div>\n          \n          {/* Rows */}\n          <div className=\"space-y-1\">\n            {featureMapping.map(({ key, label }) => {\n              const yourVal = config[key];\n              const theirVal = fullPolity.rawFeatures[key];\n              const diff = theirVal !== undefined ? (theirVal - yourVal) : null;\n              const isClose = diff !== null && Math.abs(diff) < 0.5;\n              \n              return (\n                <div key={key} className=\"grid grid-cols-4 gap-1 text-xs py-1\">\n                  <div className=\"text-gray-400\">{label}</div>\n                  <div className=\"text-center text-white\">{yourVal}</div>\n                  <div className=\"text-center text-gray-300\">\n                    {theirVal !== undefined ? theirVal.toFixed(1) : '—'}\n                  </div>\n                  <div className=\"text-right\">\n                    {diff !== null && (\n                      <span className={`px-1.5 py-0.5 rounded ${\n                        isClose \n                          ? 'bg-green-500/20 text-green-400' \n                          : diff > 0 \n                            ? 'bg-blue-500/20 text-blue-400'\n                            : 'bg-orange-500/20 text-orange-400'\n                      }`}>\n                        {isClose ? '≈' : diff > 0 ? `+${diff.toFixed(1)}` : diff.toFixed(1)}\n                      </span>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n          \n          {/* Legend */}\n          <div className=\"mt-3 pt-2 border-t border-gray-800/50 text-xs text-gray-600\">\n            <span className=\"text-green-400\">≈</span> close · \n            <span className=\"text-blue-400 ml-2\">+</span> higher · \n            <span className=\"text-orange-400 ml-2\">−</span> lower\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}